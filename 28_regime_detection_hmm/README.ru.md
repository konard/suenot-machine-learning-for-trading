# –°–∫—Ä—ã—Ç—ã–µ –ú–∞—Ä–∫–æ–≤—Å–∫–∏–µ –º–æ–¥–µ–ª–∏ (HMM) –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä—ã–Ω–æ—á–Ω—ã—Ö —Ä–µ–∂–∏–º–æ–≤

–≠—Ç–∞ –≥–ª–∞–≤–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç **—Å–∫—Ä—ã—Ç—ã–µ –ú–∞—Ä–∫–æ–≤—Å–∫–∏–µ –º–æ–¥–µ–ª–∏ (Hidden Markov Models, HMM)** –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä—ã–Ω–æ—á–Ω—ã—Ö —Ä–µ–∂–∏–º–æ–≤ –∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –∞–¥–∞–ø—Ç–∏–≤–Ω—ã—Ö —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π. –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Ä—ã–Ω–∫–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É—é—Ç –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ä–µ–∂–∏–º–∞—Ö (–±—ã—á–∏–π, –º–µ–¥–≤–µ–∂–∏–π, –±–æ–∫–æ–≤–æ–π), –∫–∞–∂–¥—ã–π —Å–æ —Å–≤–æ–∏–º–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–º–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏. HMM –ø–æ–∑–≤–æ–ª—è—é—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å —Ç–µ–∫—É—â–∏–π —Ä–µ–∂–∏–º –∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ—Ö–æ–¥–∞ –º–µ–∂–¥—É —Ä–µ–∂–∏–º–∞–º–∏.

<p align="center">
<img src="https://i.imgur.com/JmWxK9R.png" width="70%">
</p>

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–í–≤–µ–¥–µ–Ω–∏–µ –≤ —Ä—ã–Ω–æ—á–Ω—ã–µ —Ä–µ–∂–∏–º—ã](#–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-—Ä—ã–Ω–æ—á–Ω—ã–µ-—Ä–µ–∂–∏–º—ã)
   * [–ß—Ç–æ —Ç–∞–∫–æ–µ —Ä—ã–Ω–æ—á–Ω—ã–π —Ä–µ–∂–∏–º?](#—á—Ç–æ-—Ç–∞–∫–æ–µ-—Ä—ã–Ω–æ—á–Ω—ã–π-—Ä–µ–∂–∏–º)
   * [–ü–æ—á–µ–º—É —Ä–µ–∂–∏–º—ã –≤–∞–∂–Ω—ã –¥–ª—è —Ç—Ä–µ–π–¥–∏–Ω–≥–∞?](#–ø–æ—á–µ–º—É-—Ä–µ–∂–∏–º—ã-–≤–∞–∂–Ω—ã-–¥–ª—è-—Ç—Ä–µ–π–¥–∏–Ω–≥–∞)
   * [–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã —Å–º–µ–Ω—ã —Ä–µ–∂–∏–º–æ–≤](#–∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ-–ø—Ä–∏–º–µ—Ä—ã-—Å–º–µ–Ω—ã-—Ä–µ–∂–∏–º–æ–≤)
2. [–¢–µ–æ—Ä–∏—è —Å–∫—Ä—ã—Ç—ã—Ö –ú–∞—Ä–∫–æ–≤—Å–∫–∏—Ö –º–æ–¥–µ–ª–µ–π](#—Ç–µ–æ—Ä–∏—è-—Å–∫—Ä—ã—Ç—ã—Ö-–º–∞—Ä–∫–æ–≤—Å–∫–∏—Ö-–º–æ–¥–µ–ª–µ–π)
   * [–ú–∞—Ä–∫–æ–≤—Å–∫–∏–µ —Ü–µ–ø–∏](#–º–∞—Ä–∫–æ–≤—Å–∫–∏–µ-—Ü–µ–ø–∏)
   * [–°–∫—Ä—ã—Ç—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è vs –Ω–∞–±–ª—é–¥–∞–µ–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ](#—Å–∫—Ä—ã—Ç—ã–µ-—Å–æ—Å—Ç–æ—è–Ω–∏—è-vs-–Ω–∞–±–ª—é–¥–∞–µ–º—ã–µ-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ)
   * [–ü–∞—Ä–∞–º–µ—Ç—Ä—ã HMM](#–ø–∞—Ä–∞–º–µ—Ç—Ä—ã-hmm)
   * [–¢—Ä–∏ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã HMM](#—Ç—Ä–∏-—Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ-–ø—Ä–æ–±–ª–µ–º—ã-hmm)
3. [–ê–ª–≥–æ—Ä–∏—Ç–º—ã HMM](#–∞–ª–≥–æ—Ä–∏—Ç–º—ã-hmm)
   * [Forward-Backward –∞–ª–≥–æ—Ä–∏—Ç–º](#forward-backward-–∞–ª–≥–æ—Ä–∏—Ç–º)
   * [–ê–ª–≥–æ—Ä–∏—Ç–º –í–∏—Ç–µ—Ä–±–∏](#–∞–ª–≥–æ—Ä–∏—Ç–º-–≤–∏—Ç–µ—Ä–±–∏)
   * [–ê–ª–≥–æ—Ä–∏—Ç–º –ë–∞—É–º–∞-–í–µ–ª—à–∞ (EM)](#–∞–ª–≥–æ—Ä–∏—Ç–º-–±–∞—É–º–∞-–≤–µ–ª—à–∞-em)
4. [–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä—ã–Ω–æ—á–Ω—ã—Ö —Ä–µ–∂–∏–º–æ–≤](#–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ-—Ä—ã–Ω–æ—á–Ω—ã—Ö-—Ä–µ–∂–∏–º–æ–≤)
   * [–í—ã–±–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è —Ä–µ–∂–∏–º–æ–≤](#–≤—ã–±–æ—Ä-–ø—Ä–∏–∑–Ω–∞–∫–æ–≤-–¥–ª—è-—Ä–µ–∂–∏–º–æ–≤)
   * [Gaussian HMM –¥–ª—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö](#gaussian-hmm-–¥–ª—è-–Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã—Ö-–¥–∞–Ω–Ω—ã—Ö)
   * [–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∂–∏–º–æ–≤](#–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è-—Ä–µ–∂–∏–º–æ–≤)
5. [–¢–æ—Ä–≥–æ–≤–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è](#—Ç–æ—Ä–≥–æ–≤–∞—è-—Å—Ç—Ä–∞—Ç–µ–≥–∏—è)
   * [–ü–æ–¥—Å—Ç—Ä–∞—Ç–µ–≥–∏—è –¥–ª—è –±—ã—á—å–µ–≥–æ —Ä–µ–∂–∏–º–∞](#–ø–æ–¥—Å—Ç—Ä–∞—Ç–µ–≥–∏—è-–¥–ª—è-–±—ã—á—å–µ–≥–æ-—Ä–µ–∂–∏–º–∞)
   * [–ü–æ–¥—Å—Ç—Ä–∞—Ç–µ–≥–∏—è –¥–ª—è –º–µ–¥–≤–µ–∂—å–µ–≥–æ —Ä–µ–∂–∏–º–∞](#–ø–æ–¥—Å—Ç—Ä–∞—Ç–µ–≥–∏—è-–¥–ª—è-–º–µ–¥–≤–µ–∂—å–µ–≥–æ-—Ä–µ–∂–∏–º–∞)
   * [–ü–æ–¥—Å—Ç—Ä–∞—Ç–µ–≥–∏—è –¥–ª—è –±–æ–∫–æ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞](#–ø–æ–¥—Å—Ç—Ä–∞—Ç–µ–≥–∏—è-–¥–ª—è-–±–æ–∫–æ–≤–æ–≥–æ-—Ä–µ–∂–∏–º–∞)
   * [–õ–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–π](#–ª–æ–≥–∏–∫–∞-–ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è-—Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
6. [–ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞](#–ø—Ä–∏–º–µ—Ä—ã-–∫–æ–¥–∞)
7. [–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ Rust](#—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è-–Ω–∞-rust)
8. [–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–æ–±—Ä–∞–∂–µ–Ω–∏—è](#–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ-—Å–æ–æ–±—Ä–∞–∂–µ–Ω–∏—è)
9. [–†–µ—Å—É—Ä—Å—ã](#—Ä–µ—Å—É—Ä—Å—ã)

---

## –í–≤–µ–¥–µ–Ω–∏–µ –≤ —Ä—ã–Ω–æ—á–Ω—ã–µ —Ä–µ–∂–∏–º—ã

### –ß—Ç–æ —Ç–∞–∫–æ–µ —Ä—ã–Ω–æ—á–Ω—ã–π —Ä–µ–∂–∏–º?

**–†—ã–Ω–æ—á–Ω—ã–π —Ä–µ–∂–∏–º** ‚Äî —ç—Ç–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ä—ã–Ω–∫–∞, —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏–∑—É—é—â–µ–µ—Å—è –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–º –Ω–∞–±–æ—Ä–æ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö —Å–≤–æ–π—Å—Ç–≤:

| –†–µ–∂–∏–º | –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ | –¢–∏–ø–∏—á–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã |
|-------|---------------|---------------------|
| **–ë—ã—á–∏–π (Bull)** | –í–æ—Å—Ö–æ–¥—è—â–∏–π —Ç—Ä–µ–Ω–¥, –Ω–∏–∑–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å, –æ–ø—Ç–∏–º–∏–∑–º | –ù–∏–∑–∫–∏–π VIX, –∫—Ä—É—Ç–∞—è –∫—Ä–∏–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ |
| **–ú–µ–¥–≤–µ–∂–∏–π (Bear)** | –ù–∏—Å—Ö–æ–¥—è—â–∏–π —Ç—Ä–µ–Ω–¥, –≤—ã—Å–æ–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å, —Å—Ç—Ä–∞—Ö | –í—ã—Å–æ–∫–∏–π VIX, –∏–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫—Ä–∏–≤–∞—è |
| **–ë–æ–∫–æ–≤–æ–π (Sideways)** | –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç—Ä–µ–Ω–¥–∞, —Å—Ä–µ–¥–Ω—è—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å | –°—Ä–µ–¥–Ω–∏–π VIX, –ø–ª–æ—Å–∫–∞—è –∫—Ä–∏–≤–∞—è |

### –ü–æ—á–µ–º—É —Ä–µ–∂–∏–º—ã –≤–∞–∂–Ω—ã –¥–ª—è —Ç—Ä–µ–π–¥–∏–Ω–≥–∞?

–û–¥–Ω–∞ –∏ —Ç–∞ –∂–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ-—Ä–∞–∑–Ω–æ–º—É –≤ —Ä–∞–∑–Ω—ã—Ö —Ä–µ–∂–∏–º–∞—Ö:

```
Momentum —Å—Ç—Ä–∞—Ç–µ–≥–∏—è:
‚îú‚îÄ‚îÄ Bull —Ä–µ–∂–∏–º: –û—Ç–ª–∏—á–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚úÖ (+25% –≥–æ–¥–æ–≤—ã—Ö)
‚îú‚îÄ‚îÄ Bear —Ä–µ–∂–∏–º: –ö–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∞ ‚ùå (-40% –≥–æ–¥–æ–≤—ã—Ö)
‚îî‚îÄ‚îÄ Sideways —Ä–µ–∂–∏–º: –£–±—ã—Ç–∫–∏ –Ω–∞ –∫–æ–º–∏—Å—Å–∏—è—Ö ‚ö†Ô∏è (-5% –≥–æ–¥–æ–≤—ã—Ö)

Mean-reversion —Å—Ç—Ä–∞—Ç–µ–≥–∏—è:
‚îú‚îÄ‚îÄ Bull —Ä–µ–∂–∏–º: –£–ø—É—â–µ–Ω–Ω–∞—è –ø—Ä–∏–±—ã–ª—å ‚ö†Ô∏è (+5% –≥–æ–¥–æ–≤—ã—Ö)
‚îú‚îÄ‚îÄ Bear —Ä–µ–∂–∏–º: –°—Ä–µ–¥–Ω–µ üî∂ (+10% –≥–æ–¥–æ–≤—ã—Ö)
‚îî‚îÄ‚îÄ Sideways —Ä–µ–∂–∏–º: –û—Ç–ª–∏—á–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚úÖ (+20% –≥–æ–¥–æ–≤—ã—Ö)
```

**–ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è:** –í–º–µ—Å—Ç–æ –æ–¥–Ω–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –Ω–∞ –≤—Å–µ —Å–ª—É—á–∞–∏ –∂–∏–∑–Ω–∏ ‚Äî –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è –∫ —Ç–µ–∫—É—â–µ–º—É —Ä–µ–∂–∏–º—É!

### –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã —Å–º–µ–Ω—ã —Ä–µ–∂–∏–º–æ–≤

```
S&P 500 (2000-2024):
‚îú‚îÄ‚îÄ 2003-2007: Bull (—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Ä–æ—Å—Ç)
‚îú‚îÄ‚îÄ 2008-2009: Bear (—Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–π –∫—Ä–∏–∑–∏—Å)
‚îú‚îÄ‚îÄ 2010-2019: Bull (QE-—ç—Ä–∞)
‚îú‚îÄ‚îÄ 2020 Q1: Bear (COVID crash)
‚îú‚îÄ‚îÄ 2020-2021: Bull (—Å—Ç–∏–º—É–ª—ã)
‚îú‚îÄ‚îÄ 2022: Bear (–∏–Ω—Ñ–ª—è—Ü–∏—è, —Å—Ç–∞–≤–∫–∏)
‚îî‚îÄ‚îÄ 2023-2024: Bull (AI-—Ä–∞–ª–ª–∏)

Bitcoin (2017-2024):
‚îú‚îÄ‚îÄ 2017: Bull ($1k ‚Üí $20k)
‚îú‚îÄ‚îÄ 2018: Bear ($20k ‚Üí $3k)
‚îú‚îÄ‚îÄ 2019: Sideways ($3k-$12k)
‚îú‚îÄ‚îÄ 2020-2021: Bull ($10k ‚Üí $69k)
‚îú‚îÄ‚îÄ 2022: Bear ($69k ‚Üí $16k)
‚îî‚îÄ‚îÄ 2023-2024: Bull ($16k ‚Üí $70k+)
```

---

## –¢–µ–æ—Ä–∏—è —Å–∫—Ä—ã—Ç—ã—Ö –ú–∞—Ä–∫–æ–≤—Å–∫–∏—Ö –º–æ–¥–µ–ª–µ–π

### –ú–∞—Ä–∫–æ–≤—Å–∫–∏–µ —Ü–µ–ø–∏

**–ú–∞—Ä–∫–æ–≤—Å–∫–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ:** –±—É–¥—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–≤–∏—Å–∏—Ç —Ç–æ–ª—å–∫–æ –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è, –Ω–µ –æ—Ç –≤—Å–µ–π –∏—Å—Ç–æ—Ä–∏–∏.

$$P(S_{t+1} | S_t, S_{t-1}, ..., S_1) = P(S_{t+1} | S_t)$$

–≠—Ç–æ —É–ø—Ä–æ—â–∞—é—â–µ–µ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –¥–µ–ª–∞–µ—Ç –º–æ–¥–µ–ª—å –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ tractable.

### –°–∫—Ä—ã—Ç—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è vs –Ω–∞–±–ª—é–¥–∞–µ–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

–í HMM –º—ã —Ä–∞–∑–ª–∏—á–∞–µ–º:

- **–°–∫—Ä—ã—Ç—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è (Z):** –ò—Å—Ç–∏–Ω–Ω—ã–π —Ä–µ–∂–∏–º —Ä—ã–Ω–∫–∞ (Bull/Bear/Sideways) ‚Äî –º—ã –Ω–µ –Ω–∞–±–ª—é–¥–∞–µ–º –Ω–∞–ø—Ä—è–º—É—é
- **–ù–∞–±–ª—é–¥–∞–µ–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (X):** –î–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏, –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å, VIX –∏ –¥—Ä—É–≥–∏–µ –∏–∑–º–µ—Ä–∏–º—ã–µ –≤–µ–ª–∏—á–∏–Ω—ã

```
–°–∫—Ä—ã—Ç—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è:  [Bull] ‚Üí [Bull] ‚Üí [Bear] ‚Üí [Bear] ‚Üí [Sideways]
                       ‚Üì        ‚Üì        ‚Üì        ‚Üì          ‚Üì
–ù–∞–±–ª—é–¥–µ–Ω–∏—è:          +2%      +1%      -3%      -2%        +0.5%
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã HMM

HMM –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Ç—Ä–µ–º—è –Ω–∞–±–æ—Ä–∞–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:

1. **–ù–∞—á–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ œÄ:** –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –Ω–∞—á–∞—Ç—å –≤ –∫–∞–∂–¥–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏
   $$\pi_i = P(Z_1 = i)$$

2. **–ú–∞—Ç—Ä–∏—Ü–∞ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ A:** –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ –º–µ–∂–¥—É —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏
   $$a_{ij} = P(Z_{t+1} = j | Z_t = i)$$

3. **–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —ç–º–∏—Å—Å–∏–π B:** –ö–∞–∫ –∫–∞–∂–¥–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –Ω–∞–±–ª—é–¥–µ–Ω–∏—è
   - –î–ª—è Gaussian HMM: $b_i(x) = \mathcal{N}(x; \mu_i, \Sigma_i)$

### –¢—Ä–∏ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã HMM

| –ü—Ä–æ–±–ª–µ–º–∞ | –û–ø–∏—Å–∞–Ω–∏–µ | –ê–ª–≥–æ—Ä–∏—Ç–º |
|----------|----------|----------|
| **–û—Ü–µ–Ω–∫–∞** | –ö–∞–∫–æ–≤–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –Ω–∞–±–ª—é–¥–∞–µ–º–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏? | Forward-Backward |
| **–î–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ** | –ö–∞–∫–∞—è –Ω–∞–∏–±–æ–ª–µ–µ –≤–µ—Ä–æ—è—Ç–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–π? | Viterbi |
| **–û–±—É—á–µ–Ω–∏–µ** | –ö–∞–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–∞–∫—Å–∏–º–∏–∑–∏—Ä—É—é—Ç –ø—Ä–∞–≤–¥–æ–ø–æ–¥–æ–±–∏–µ? | Baum-Welch (EM) |

---

## –ê–ª–≥–æ—Ä–∏—Ç–º—ã HMM

### Forward-Backward –∞–ª–≥–æ—Ä–∏—Ç–º

–í—ã—á–∏—Å–ª—è–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –Ω–∞–±–ª—é–¥–µ–Ω–∏–π –∏ –∞–ø–æ—Å—Ç–µ—Ä–∏–æ—Ä–Ω—ã–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–π.

**Forward –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:**
$$\alpha_t(i) = P(X_1, ..., X_t, Z_t = i)$$

**Backward –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:**
$$\beta_t(i) = P(X_{t+1}, ..., X_T | Z_t = i)$$

**–ê–ø–æ—Å—Ç–µ—Ä–∏–æ—Ä–Ω–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏—è:**
$$\gamma_t(i) = P(Z_t = i | X_1, ..., X_T) = \frac{\alpha_t(i) \beta_t(i)}{\sum_j \alpha_t(j) \beta_t(j)}$$

### –ê–ª–≥–æ—Ä–∏—Ç–º –í–∏—Ç–µ—Ä–±–∏

–ù–∞—Ö–æ–¥–∏—Ç –Ω–∞–∏–±–æ–ª–µ–µ –≤–µ—Ä–æ—è—Ç–Ω—É—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–∫—Ä—ã—Ç—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π (–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ):

```python
def viterbi(observations, hmm):
    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    delta[0] = pi * B(observations[0])

    # –†–µ–∫—É—Ä—Å–∏—è
    for t in range(1, T):
        for j in range(N):
            delta[t, j] = max_i(delta[t-1, i] * A[i,j]) * B_j(observations[t])
            psi[t, j] = argmax_i(delta[t-1, i] * A[i,j])

    # Backtracking
    path[T-1] = argmax(delta[T-1])
    for t in range(T-2, -1, -1):
        path[t] = psi[t+1, path[t+1]]

    return path
```

### –ê–ª–≥–æ—Ä–∏—Ç–º –ë–∞—É–º–∞-–í–µ–ª—à–∞ (EM)

–ò—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ —É–ª—É—á—à–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏:

**E-—à–∞–≥:** –í—ã—á–∏—Å–ª–∏—Ç—å –æ–∂–∏–¥–∞–µ–º—ã–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Å —Ç–µ–∫—É—â–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
- $\gamma_t(i)$ ‚Äî –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –±—ã—Ç—å –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ i –≤ –º–æ–º–µ–Ω—Ç t
- $\xi_t(i,j)$ ‚Äî –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø–µ—Ä–µ—Ö–æ–¥–∞ i‚Üíj –≤ –º–æ–º–µ–Ω—Ç t

**M-—à–∞–≥:** –û–±–Ω–æ–≤–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
$$\hat{a}_{ij} = \frac{\sum_{t=1}^{T-1} \xi_t(i,j)}{\sum_{t=1}^{T-1} \gamma_t(i)}$$

$$\hat{\mu}_i = \frac{\sum_{t=1}^{T} \gamma_t(i) x_t}{\sum_{t=1}^{T} \gamma_t(i)}$$

---

## –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä—ã–Ω–æ—á–Ω—ã—Ö —Ä–µ–∂–∏–º–æ–≤

### –í—ã–±–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è —Ä–µ–∂–∏–º–æ–≤

–•–æ—Ä–æ—à–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–µ–∂–∏–º–æ–≤:

```python
features = [
    'return_20d',       # 20-–¥–Ω–µ–≤–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å (—Ç—Ä–µ–Ω–¥)
    'volatility_20d',   # 20-–¥–Ω–µ–≤–Ω–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å (—Ä–∏—Å–∫)
    'vix_level',        # –ò–Ω–¥–µ–∫—Å —Å—Ç—Ä–∞—Ö–∞ (—Å–µ–Ω—Ç–∏–º–µ–Ω—Ç)
    'yield_slope',      # –ù–∞–∫–ª–æ–Ω –∫—Ä–∏–≤–æ–π –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ (–º–∞–∫—Ä–æ)
    'credit_spread',    # –ö—Ä–µ–¥–∏—Ç–Ω—ã–π —Å–ø—Ä–µ–¥ (—Ä–∏—Å–∫-–∞–ø–ø–µ—Ç–∏—Ç)
    'rsi_14',           # RSI (–ø–µ—Ä–µ–∫—É–ø–ª–µ–Ω–Ω–æ—Å—Ç—å/–ø–µ—Ä–µ–ø—Ä–æ–¥–∞–Ω–Ω–æ—Å—Ç—å)
    'macd_signal',      # MACD (–º–æ–º–µ–Ω—Ç—É–º)
    'volume_ratio'      # –û–±—ä—ë–º –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Å—Ä–µ–¥–Ω–µ–≥–æ
]
```

### Gaussian HMM –¥–ª—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

```python
from hmmlearn import hmm

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è 3-—Ä–µ–∂–∏–º–Ω–æ–π –º–æ–¥–µ–ª–∏
model = hmm.GaussianHMM(
    n_components=3,           # Bull, Bear, Sideways
    covariance_type="full",   # –ü–æ–ª–Ω–∞—è –∫–æ–≤–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞
    n_iter=1000,              # –ò—Ç–µ—Ä–∞—Ü–∏–π EM
    random_state=42,
    tol=1e-4                  # –ü–æ—Ä–æ–≥ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏
)

# –û–±—É—á–µ–Ω–∏–µ –Ω–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
model.fit(features_scaled)

# –î–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∂–∏–º–æ–≤
hidden_states = model.predict(features_scaled)
state_probs = model.predict_proba(features_scaled)
```

### –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∂–∏–º–æ–≤

–ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è –Ω—É–∂–Ω–æ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å, –∫–∞–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∫–∞–∫–æ–º—É —Ä–µ–∂–∏–º—É:

```python
# –ê–Ω–∞–ª–∏–∑ —Å—Ä–µ–¥–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π –∫–∞–∂–¥–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
for i in range(model.n_components):
    mask = hidden_states == i
    avg_return = returns[mask].mean() * 252  # –ì–æ–¥–æ–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å
    avg_vol = volatility[mask].mean() * np.sqrt(252)  # –ì–æ–¥–æ–≤–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å

    if avg_return > 0.10 and avg_vol < 0.20:
        regime_names[i] = "Bull"
    elif avg_return < -0.10 or avg_vol > 0.25:
        regime_names[i] = "Bear"
    else:
        regime_names[i] = "Sideways"
```

### –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —Ä–µ–∂–∏–º–æ–≤ (–æ–∂–∏–¥–∞–µ–º—ã–µ)

| –†–µ–∂–∏–º | –ì–æ–¥–æ–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å | –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å | –°—Ä–µ–¥–Ω—è—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å |
|-------|-------------------|---------------|---------------------|
| **Bull** | +15% | 12% | 24 –º–µ—Å—è—Ü–∞ |
| **Bear** | -20% | 25% | 8 –º–µ—Å—è—Ü–µ–≤ |
| **Sideways** | +5% | 15% | 12 –º–µ—Å—è—Ü–µ–≤ |

### –ú–∞—Ç—Ä–∏—Ü–∞ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ (–ø—Ä–∏–º–µ—Ä)

```
              –ö Bull   –ö Bear   –ö Sideways
–û—Ç Bull        0.92     0.03      0.05
–û—Ç Bear        0.08     0.85      0.07
–û—Ç Sideways    0.10     0.08      0.82
```

**–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**
- Bull —Ä–µ–∂–∏–º —Å–∞–º—ã–π "–ª–∏–ø–∫–∏–π" (92% –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ—Å—Ç–∞—Ç—å—Å—è)
- Bear —Ä–µ–∂–∏–º –±—ã—Å—Ç—Ä–µ–µ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è (15% –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø–µ—Ä–µ—Ö–æ–¥–∞)
- –ü–µ—Ä–µ—Ö–æ–¥ Bear ‚Üí Bull —Ä–µ–¥–æ–∫ (8%), –æ–±—ã—á–Ω–æ —á–µ—Ä–µ–∑ Sideways

---

## –¢–æ—Ä–≥–æ–≤–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è

### –°—É—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏

HMM –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–µ–∫—É—â–∏–π —Ä–µ–∂–∏–º ‚Üí –≤—ã–±–∏—Ä–∞–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –ø–æ–¥—Å—Ç—Ä–∞—Ç–µ–≥–∏—é:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   HMM Detector  ‚îÇ
‚îÇ  (—Ä–µ–∂–∏–º + prob) ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚ñº         ‚ñº         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Bull  ‚îÇ ‚îÇ Bear  ‚îÇ ‚îÇSideways‚îÇ
‚îÇStrategy‚îÇ ‚îÇStrategy‚îÇ ‚îÇStrategy‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
    ‚îÇ         ‚îÇ         ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚ñº
   Portfolio Weights
```

### –ü–æ–¥—Å—Ç—Ä–∞—Ç–µ–≥–∏—è –¥–ª—è –±—ã—á—å–µ–≥–æ —Ä–µ–∂–∏–º–∞

**–¶–µ–ª—å:** –ú–∞–∫—Å–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å exposure –∫ —Ä–∞—Å—Ç—É—â–µ–º—É —Ä—ã–Ω–∫—É

```python
bull_strategy = {
    'equity_allocation': 1.0,      # 100% –∞–∫—Ü–∏–π
    'factor_tilts': ['momentum', 'small_cap'],
    'hedges': None,
    'leverage': 1.0,               # –ë–µ–∑ –ø–ª–µ—á–∞
    'rebalance_freq': 'monthly'
}
```

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- Long equity (100% allocation)
- Momentum factor tilt
- Small cap overweight
- –ë–µ–∑ —Ö–µ–¥–∂–µ–π

### –ü–æ–¥—Å—Ç—Ä–∞—Ç–µ–≥–∏—è –¥–ª—è –º–µ–¥–≤–µ–∂—å–µ–≥–æ —Ä–µ–∂–∏–º–∞

**–¶–µ–ª—å:** –ó–∞—â–∏—Ç–∞ –∫–∞–ø–∏—Ç–∞–ª–∞, –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Å–∞–¥–∫–∏

```python
bear_strategy = {
    'equity_allocation': 0.30,     # –¢–æ–ª—å–∫–æ 30% –∞–∫—Ü–∏–π
    'bonds_allocation': 0.40,      # 40% –≤ –¥–ª–∏–Ω–Ω—ã—Ö –æ–±–ª–∏–≥–∞—Ü–∏—è—Ö
    'gold_allocation': 0.20,       # 20% –≤ –∑–æ–ª–æ—Ç–µ
    'cash_allocation': 0.10,       # 10% –∫—ç—à
    'hedges': ['vix_calls'],       # –û–ø—Ü–∏–æ–Ω—ã –Ω–∞ VIX
}
```

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- Reduced equity (30% allocation)
- Long-term treasuries (40%)
- Gold allocation (20%)
- Cash buffer (10%)
- VIX calls hedge

### –ü–æ–¥—Å—Ç—Ä–∞—Ç–µ–≥–∏—è –¥–ª—è –±–æ–∫–æ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞

**–¶–µ–ª—å:** –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∞–ª—å—Ñ—ã –∏–∑ mean-reversion

```python
sideways_strategy = {
    'equity_allocation': 0.50,     # 50% –∞–∫—Ü–∏–π
    'pairs_trading': True,         # –ü–∞—Ä–Ω—ã–π —Ç—Ä–µ–π–¥–∏–Ω–≥
    'sector_rotation': True,       # –†–æ—Ç–∞—Ü–∏—è —Å–µ–∫—Ç–æ—Ä–æ–≤
    'mean_reversion': True,        # Mean-reversion —Å–∏–≥–Ω–∞–ª—ã
}
```

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- Market neutral (50% equity)
- Pairs trading overlay
- Sector rotation
- Enhanced yield strategies

### –õ–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–π

```python
def get_current_strategy(state_probs, current_positions):
    """
    –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–µ–∫—É—â—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é —Å —É—á—ë—Ç–æ–º:
    1. Posterior probability —Ä–µ–∂–∏–º–∞ (—Å–≥–ª–∞–∂–µ–Ω–Ω–∞—è)
    2. –ü–æ—Ä–æ–≥–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è
    3. –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –≤ —Ä–µ–∂–∏–º–µ (–ø—Ä–æ—Ç–∏–≤ whipsaws)
    4. Transaction costs
    """

    # –°–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π
    smoothed_probs = ema(state_probs, span=5)

    # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–æ–º–∏–Ω–∏—Ä—É—é—â–µ–≥–æ —Ä–µ–∂–∏–º–∞
    dominant_regime = np.argmax(smoothed_probs)
    confidence = smoothed_probs[dominant_regime]

    # –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏
    if confidence > SWITCH_THRESHOLD:  # –Ω–∞–ø—Ä–∏–º–µ—Ä, 0.70
        if time_in_regime > MIN_REGIME_DURATION:  # –º–∏–Ω–∏–º—É–º 5 –¥–Ω–µ–π
            return strategies[dominant_regime]

    # –ò–Ω–∞—á–µ –æ—Å—Ç–∞—ë–º—Å—è –≤ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
    return current_strategy
```

---

## –ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞

| –ù–æ—É—Ç–±—É–∫ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| [01_data_preparation.ipynb](01_data_preparation.ipynb) | –ó–∞–≥—Ä—É–∑–∫–∞ S&P 500, VIX, yields, macro –¥–∞–Ω–Ω—ã—Ö |
| [02_hmm_theory.ipynb](02_hmm_theory.ipynb) | –¢–µ–æ—Ä–∏—è HMM: forward-backward, Viterbi, Baum-Welch |
| [03_regime_features.ipynb](03_regime_features.ipynb) | Feature engineering –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–µ–∂–∏–º–æ–≤ |
| [04_gaussian_hmm.ipynb](04_gaussian_hmm.ipynb) | –û–±—É—á–µ–Ω–∏–µ Gaussian HMM —Å hmmlearn |
| [05_regime_interpretation.ipynb](05_regime_interpretation.ipynb) | –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∂–∏–º–æ–≤, –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è |
| [06_regime_characteristics.ipynb](06_regime_characteristics.ipynb) | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–∞–∂–¥–æ–≥–æ —Ä–µ–∂–∏–º–∞ (return, vol, duration) |
| [07_substrategy_bull.ipynb](07_substrategy_bull.ipynb) | Momentum —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –¥–ª—è bull —Ä–µ–∂–∏–º–∞ |
| [08_substrategy_bear.ipynb](08_substrategy_bear.ipynb) | Defensive —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –¥–ª—è bear —Ä–µ–∂–∏–º–∞ |
| [09_substrategy_sideways.ipynb](09_substrategy_sideways.ipynb) | Mean-reversion –¥–ª—è sideways —Ä–µ–∂–∏–º–∞ |
| [10_strategy_switching.ipynb](10_strategy_switching.ipynb) | –õ–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –º–µ–∂–¥—É —Å—Ç—Ä–∞—Ç–µ–≥–∏—è–º–∏ |
| [11_backtesting.ipynb](11_backtesting.ipynb) | Full backtest —Å transaction costs |
| [12_robustness_analysis.ipynb](12_robustness_analysis.ipynb) | Sensitivity analysis, out-of-sample |

---

## –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ Rust

–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è [rust_hmm_trading](rust_hmm_trading/) —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–Ω—É—é Rust-—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –¥–ª—è –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω–æ–≥–æ —Ä—ã–Ω–∫–∞ (Bybit):

```
rust_hmm_trading/
‚îú‚îÄ‚îÄ Cargo.toml              # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞
‚îú‚îÄ‚îÄ README.md               # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Rust-–ø—Ä–æ–µ–∫—Ç–∞
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ lib.rs              # –ì–ª–∞–≤–Ω—ã–π –º–æ–¥—É–ª—å –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ main.rs             # CLI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ api/                # Bybit API –∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ mod.rs
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ bybit.rs        # –ö–ª–∏–µ–Ω—Ç –¥–ª—è Bybit
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ error.rs        # –¢–∏–ø—ã –æ—à–∏–±–æ–∫
‚îÇ   ‚îú‚îÄ‚îÄ data/               # –†–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ mod.rs
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ types.rs        # Candle, OHLCV, Dataset
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ features.rs     # Feature engineering
‚îÇ   ‚îú‚îÄ‚îÄ models/             # HMM –º–æ–¥–µ–ª–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ mod.rs
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ hmm.rs          # –û—Å–Ω–æ–≤–Ω–∞—è HMM —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ gaussian.rs     # Gaussian emissions
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ algorithms.rs   # Viterbi, Forward-Backward, Baum-Welch
‚îÇ   ‚îú‚îÄ‚îÄ regime/             # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–∂–∏–º–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ mod.rs
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ detector.rs     # –î–µ—Ç–µ–∫—Ç–æ—Ä —Ä–µ–∂–∏–º–æ–≤
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ interpreter.rs  # –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ strategies/         # –¢–æ—Ä–≥–æ–≤—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ mod.rs
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ bull.rs         # –ë—ã—á—å—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ bear.rs         # –ú–µ–¥–≤–µ–∂—å—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ sideways.rs     # –ë–æ–∫–æ–≤–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ switcher.rs     # –õ–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ trading/            # –ë—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥
‚îÇ       ‚îú‚îÄ‚îÄ mod.rs
‚îÇ       ‚îú‚îÄ‚îÄ backtest.rs     # –ë—ç–∫—Ç–µ—Å—Ç–µ—Ä
‚îÇ       ‚îú‚îÄ‚îÄ metrics.rs      # –ú–µ—Ç—Ä–∏–∫–∏ (Sharpe, Drawdown)
‚îÇ       ‚îî‚îÄ‚îÄ portfolio.rs    # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ä—Ç—Ñ–µ–ª–µ–º
‚îî‚îÄ‚îÄ examples/
    ‚îú‚îÄ‚îÄ fetch_data.rs       # –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å Bybit
    ‚îú‚îÄ‚îÄ train_hmm.rs        # –û–±—É—á–µ–Ω–∏–µ HMM
    ‚îú‚îÄ‚îÄ detect_regimes.rs   # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–∂–∏–º–æ–≤
    ‚îî‚îÄ‚îÄ full_backtest.rs    # –ü–æ–ª–Ω—ã–π –±—ç–∫—Ç–µ—Å—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
```

–°–º–æ—Ç—Ä–∏—Ç–µ [rust_hmm_trading/README.md](rust_hmm_trading/README.md) –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π.

---

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–æ–±—Ä–∞–∂–µ–Ω–∏—è

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å HMM –¥–ª—è —Ä–µ–∂–∏–º–æ–≤

**–•–æ—Ä–æ—à–∏–µ –∫–µ–π—Å—ã:**
- –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ (—Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ —Ä–∞–∑ –≤ –º–µ—Å—è—Ü)
- Adaptive asset allocation
- Tail-risk hedging (–ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ –∑–∞—â–∏—Ç–Ω—ã–µ –∞–∫—Ç–∏–≤—ã)
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ "—Ä—ã–Ω–æ—á–Ω–æ–π –ø–æ–≥–æ–¥—ã" –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π

**–ù–µ –∏–¥–µ–∞–ª—å–Ω–æ –¥–ª—è:**
- High-frequency trading (—Å–ª–∏—à–∫–æ–º –º–µ–¥–ª–µ–Ω–Ω–æ —Ä–µ–∞–≥–∏—Ä—É–µ—Ç)
- –ö–æ–≥–¥–∞ –Ω—É–∂–Ω–∞ –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞
- –ü—Ä–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö (–Ω—É–∂–Ω–æ 10+ –ª–µ—Ç)
- –°–∏–ª—å–Ω–æ –Ω–µ—Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω—ã–µ —Ä—ã–Ω–∫–∏

### –ü–æ–¥–≤–æ–¥–Ω—ã–µ –∫–∞–º–Ω–∏

1. **Look-ahead bias:** –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±—É–¥—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–µ–∂–∏–º–∞!

2. **Label switching:** HMM –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ 0 ‚Äî –≤—Å–µ–≥–¥–∞ Bull. –ù—É–∂–Ω–æ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å.

3. **Overfitting:** –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏–π ‚Üí –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ. 2-4 —Å–æ—Å—Ç–æ—è–Ω–∏—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ.

4. **Whipsaws:** –ß–∞—Å—Ç—ã–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è = –±–æ–ª—å—à–∏–µ transaction costs. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ.

5. **–ò–∑–º–µ–Ω–µ–Ω–∏–µ –¥–∏–Ω–∞–º–∏–∫–∏:** –†–µ–∂–∏–º—ã 2008 –≥–æ–¥–∞ ‚â† —Ä–µ–∂–∏–º—ã 2024 –≥–æ–¥–∞. –ù—É–∂–Ω–∞ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ.

### –í—ã–±–æ—Ä –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π

| –°–æ—Å—Ç–æ—è–Ω–∏–π | –ü–ª—é—Å—ã | –ú–∏–Ω—É—Å—ã |
|-----------|-------|--------|
| 2 | –ü—Ä–æ—Å—Ç–æ—Ç–∞, —Ä–æ–±–∞—Å—Ç–Ω–æ—Å—Ç—å | –¢–µ—Ä—è–µ–º Sideways |
| 3 | –ò–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ (Bull/Bear/Sideways) | –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤—ã–±–æ—Ä |
| 4 | –†–∞–∑–ª–∏—á–∞–µ–º High/Low –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å | –°–ª–æ–∂–Ω–µ–µ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å |
| 5+ | –ë–æ–ª—å—à–µ –Ω—é–∞–Ω—Å–æ–≤ | –ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ, –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å |

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ù–∞—á–Ω–∏—Ç–µ —Å 3 —Å–æ—Å—Ç–æ—è–Ω–∏–π, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ AIC/BIC –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏.

### –ú–µ—Ç—Ä–∏–∫–∏ –æ—Ü–µ–Ω–∫–∏

**–î–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏ —Ä–µ–∂–∏–º–æ–≤:**
- Accuracy vs NBER recession dates
- Average regime duration (—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ –ª–∏?)
- False switch rate

**–î–ª—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏:**
- Sharpe Ratio (>1.0 –∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ)
- Max Drawdown (<20% –∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ)
- Calmar Ratio (Return/MaxDD)
- Comparison vs benchmarks (Buy&Hold, 60/40)

---

## –†–µ—Å—É—Ä—Å—ã

### –°—Ç–∞—Ç—å–∏

- [Regime Switching Models for Financial Time Series](https://papers.ssrn.com/sol3/papers.cfm?abstract_id=1339685) ‚Äî Hamilton, 1989
- [Hidden Markov Models for Time Series](https://www.routledge.com/Hidden-Markov-Models-for-Time-Series-An-Introduction-Using-R/Zucchini-MacDonald-Langrock/p/book/9781482253832) ‚Äî Zucchini et al.
- [Market Regime Detection Using Machine Learning](https://jpm.pm-research.com/) ‚Äî JPM Research
- [Detecting Regime Changes in Financial Markets](https://arxiv.org/abs/1901.04826) ‚Äî Ardia et al., 2019

### –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏

- [hmmlearn](https://hmmlearn.readthedocs.io/) ‚Äî Python HMM library
- [pomegranate](https://pomegranate.readthedocs.io/) ‚Äî Probabilistic models including HMM
- [PyPortfolioOpt](https://pyportfolioopt.readthedocs.io/) ‚Äî Portfolio optimization

### –°–≤—è–∑–∞–Ω–Ω—ã–µ –≥–ª–∞–≤—ã

- [–ì–ª–∞–≤–∞ 09: –ú–æ–¥–µ–ª–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤](../09_time_series_models) ‚Äî ARIMA, GARCH –¥–ª—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
- [–ì–ª–∞–≤–∞ 10: –ë–∞–π–µ—Å–æ–≤—Å–∫–æ–µ –º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ](../10_bayesian_machine_learning) ‚Äî –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã
- [–ì–ª–∞–≤–∞ 11: Random Forests](../11_decision_trees_random_forests) ‚Äî –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã —Ä–µ–∂–∏–º–æ–≤
- [–ì–ª–∞–≤–∞ 23: –û–±—É—á–µ–Ω–∏–µ —Å –ø–æ–¥–∫—Ä–µ–ø–ª–µ–Ω–∏–µ–º](../23_reinforcement_learning_for_trading) ‚Äî –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏

---

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```python
# Python
hmmlearn>=0.3.0
pomegranate>=1.0.0
pandas>=1.5.0
numpy>=1.23.0
matplotlib>=3.6.0
seaborn>=0.12.0
scipy>=1.10.0
yfinance>=0.2.0
scikit-learn>=1.2.0
```

```toml
# Rust (Cargo.toml)
ndarray = "0.15"
ndarray-linalg = "0.16"
statrs = "0.16"
reqwest = { version = "0.11", features = ["json"] }
tokio = { version = "1", features = ["full"] }
serde = { version = "1.0", features = ["derive"] }
```

---

## –£—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏

‚≠ê‚≠ê‚≠ê‚òÜ‚òÜ (–°—Ä–µ–¥–Ω–∏–π)

**–¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–Ω–∏–º–∞–Ω–∏–µ:**
- –¢–µ–æ—Ä–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π (–ú–∞—Ä–∫–æ–≤—Å–∫–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã)
- –ê–ª–≥–æ—Ä–∏—Ç–º EM (Expectation-Maximization)
- Time series analysis
- Portfolio construction

**–í—Ä–µ–º—è –æ—Å–≤–æ–µ–Ω–∏—è:** 2-3 –Ω–µ–¥–µ–ª–∏
