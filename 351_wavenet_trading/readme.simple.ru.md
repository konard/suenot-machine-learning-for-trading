# WaveNet: Как компьютер учится предсказывать будущее

## Что такое WaveNet?

Представь, что у тебя есть волшебный друг, который слушает музыку и может предсказать, какая нота будет следующей. Вот примерно этим и занимается **WaveNet**!

WaveNet создали в Google DeepMind, чтобы компьютеры могли говорить человеческим голосом. Но умные учёные обнаружили, что он также может предсказывать цены на бирже!

---

## Магия взгляда в прошлое

### История детектива

Представь, что ты детектив и пытаешься предсказать, что твой друг будет есть на обед завтра. Ты можешь:

1. **Посмотреть на вчера**: "Она ела пиццу вчера, может, и сегодня пицца?"
2. **Посмотреть на всю неделю**: "Хм, пицца в понедельник, салат во вторник, пицца в среду..."
3. **Посмотреть на весь месяц**: "Вижу закономерность! Она любит пиццу по понедельникам и пятницам!"

Чем дальше смотришь назад, тем лучше можешь предсказать!

**WaveNet - это супер-детектив**, который может смотреть назад на ТЫСЯЧИ дней одновременно и находить закономерности!

---

## Игра в испорченный телефон, но по-другому

### Обычные нейросети (как испорченный телефон)

Помнишь игру в испорченный телефон? Шепчешь сообщение от человека к человеку:

```
Человек 1 → Человек 2 → Человек 3 → Человек 4 → Человек 5
"Яблоко"   "Яблоко"    "Ябмоко"    "Облако"    "Молоко"
```

К концу сообщение искажается! Это проблема обычных нейросетей - информация "теряется", проходя через много шагов.

### WaveNet (как групповой чат)

WaveNet работает по-другому! Это как групповой чат, где все могут читать ВСЕ предыдущие сообщения сразу:

```
Человек 1: "Яблоко"
Человек 2: (видит Человека 1) "Яблочный пирог?"
Человек 3: (видит Человека 1, 2) "Рецепт яблочного пирога!"
Человек 4: (видит ВСЕХ) "Рецепт яблочного пирога с корицей!"
```

Никакая информация не теряется, потому что каждый видит всё!

---

## Паттерн прыжков и пропусков

### Что такое "расширенные" свёртки?

Представь, что читаешь очень длинную книгу и хочешь быстро понять весь сюжет. Ты можешь:

1. **Читать каждое слово** (это вечность!)
2. **Читать каждое второе слово** (быстрее, но можно упустить детали)
3. **Умные пропуски**: Читать каждое слово на странице 1, каждое 2-е на странице 2, каждое 4-е на странице 3...

Эти "умные пропуски" называются **расширением (dilation)**!

### Визуальный пример

```
Смотрим на погоду сегодня, чтобы предсказать завтра:

Обычный способ:  [Сегодня] [Вчера] [2 дня назад] [3 дня назад]
                    ●─────────●─────────●─────────────●

Расширенный способ: [Сегодня] [Вчера] [3 дня назад] [7 дней назад] [15 дней назад]
                       ●─────────●────────────●───────────────────●───────────────────●
```

С расширением можно видеть НАМНОГО дальше в прошлое, делая меньше работы!

---

## Примеры из жизни

### Пример 1: Магазин мороженого

Представь, что у тебя свой магазин мороженого и ты хочешь предсказать, сколько мороженого продашь завтра.

**Без WaveNet (смотрим только на вчера)**:
- Вчера продал 50 мороженых
- Прогноз: "Может, опять 50?"

**С WaveNet (смотрим на закономерности)**:
- Вчера (воскресенье): 50 мороженых
- Прошлое воскресенье: 55 мороженых
- Две недели назад (воскресенье): 48 мороженых
- Плюс: В прошлом месяце было жарко, продажи выросли!
- Плюс: Завтра начинаются школьные каникулы!

WaveNet видит ВСЕ эти закономерности и предсказывает: "70 мороженых!"

### Пример 2: Предсказатель музыки

Ты слушаешь "В лесу родилась ёлочка":

```
В лесу родилась ёлочка, в лесу она росла...
```

Что дальше? Если ты слышал песню раньше, то знаешь: "Зимой и летом стройная, зелёная была!"

WaveNet работает так же - учит закономерности из истории и предсказывает, что будет дальше!

### Пример 3: Угадыватель цен

Цены на биткоин - как американские горки:

```
Понедельник: 50,000$ (выросла)
Вторник:     51,000$ (опять выросла)
Среда:       50,500$ (немного упала)
Четверг:     52,000$ (вверх!)
Пятница:     ???
```

WaveNet смотрит на закономерность и думает:
- "В целом цены растут"
- "Было небольшое падение в середине недели"
- "Похожая ситуация была в прошлом месяце, и в пятницу цена выросла!"

Прогноз: "Скорее всего, около 52,500$!"

---

## Как WaveNet видит закономерности

### Расширяющийся обзор

Представь, что смотришь через разные бинокли:

| Слой | Что видишь | Пример из жизни |
|------|------------|-----------------|
| Слой 1 | Вчера | "Что было вчера?" |
| Слой 2 | Последние 2 дня | "Что было на этой неделе?" |
| Слой 3 | Последние 4 дня | "Какой был тренд?" |
| Слой 4 | Последние 8 дней | "А что на прошлой неделе?" |
| Слой 5 | Последние 16 дней | "Есть месячные закономерности?" |
| Слой 6 | Последние 32 дня | "Что было в прошлом месяце?" |

Каждый слой видит всё дальше и дальше!

### Магическое число

Всего с **10 слоями** WaveNet может видеть назад на **1024 временных шага**!

Это как уметь помнить:
- 1024 часа = **42 дня** часовых данных
- 1024 минуты = **17 часов** поминутных данных
- 1024 дня = **почти 3 года** дневных данных!

---

## Страж ворот

### Что такое вентильные активации?

Представь, что у тебя есть умный фильтр для мозга, который решает:
1. **Что запомнить** (важное)
2. **Что забыть** (не нужное)

WaveNet использует два фильтра:
- **Фильтр 1 (tanh)**: "Что интересно?"
- **Фильтр 2 (sigmoid)**: "Насколько это важно?"

Вместе они работают так:

```
Приходит информация
         ↓
Фильтр 1: "Этот скачок цены интересный!"
Фильтр 2: "И он ОЧЕНЬ важный!"
         ↓
Результат: "ЗАПОМНИ ЭТО КРЕПКО!"
```

Или:

```
Приходит информация
         ↓
Фильтр 1: "Это крошечное изменение скучное..."
Фильтр 2: "И оно не важное"
         ↓
Результат: "Забудь об этом"
```

---

## Почему это важно для трейдинга

### Преимущество

| Старый способ | Способ WaveNet |
|---------------|----------------|
| Смотрит на недавние данные | Видит далеко в прошлое |
| Медленно учится | Быстро учится |
| Забывает старые закономерности | Помнит всё |
| Нужно много слоёв | Работает с меньшим числом слоёв |

### Реальное применение в трейдинге

1. **Утро**: WaveNet смотрит на все цены биткоина за последний месяц
2. **Анализ**: Находит закономерности типа "цены обычно падают в 3 часа дня по пятницам"
3. **Прогноз**: "Сегодня пятница, цена может упасть в 3 часа"
4. **Действие**: "Может, подождать до 3 часов, чтобы купить!"

---

## День из жизни WaveNet

```
8:00 - WaveNet просыпается и читает всю историю цен
8:01 - Находит 5 интересных закономерностей:
       - Недельный цикл (цены растут по понедельникам)
       - Месячная закономерность (падение в конце месяца)
       - Похожее движение цены было в январе 2024
       - Объём растёт (люди покупают!)
       - Новостной фон позитивный
8:02 - Делает прогноз: "Цена вырастет на 2%"
8:03 - Торговая система: "ПОКУПАЕМ!"
```

---

## Интересные факты о WaveNet

1. **Создан для музыки**: WaveNet изначально создали для генерации человеческого голоса! Google использует его в Google Ассистенте.

2. **Супер-память**: Может "помнить" тысячи точек данных одновременно.

3. **Быстрый ученик**: Учится намного быстрее старых моделей, потому что может смотреть на всё параллельно.

4. **Не идеален**: Как любой прогноз, может ошибаться! Рынки непредсказуемы.

---

## Итог: WaveNet в 5 пунктах

1. **Это искатель закономерностей**: Как детектив, ищущий подсказки в истории цен

2. **Умно пропускает**: Использует "расширенные" свёртки, чтобы эффективно видеть далеко назад

3. **Помнит всё**: Использует skip-соединения, чтобы никакая информация не терялась

4. **Умно фильтрует**: Использует "ворота", чтобы фокусироваться на важных закономерностях

5. **Предсказывает быстро**: Может делать прогнозы быстро, потому что обрабатывает данные параллельно

---

## Что дальше?

Теперь, когда ты понимаешь WaveNet, можешь:

1. **Посмотреть код**: Загляни в папку `rust/` за рабочими примерами
2. **Проводить эксперименты**: Получить реальные данные биткоина и делать прогнозы
3. **Узнать больше**: Прочитай основной README.md для технических деталей

---

## Быстрый тест!

**Вопрос 1**: Почему WaveNet лучше, чем просто смотреть на вчерашнюю цену?
<details>
<summary>Ответ</summary>
Потому что он может видеть закономерности за недели или месяцы, а не только за вчера!
</details>

**Вопрос 2**: Что значит "расширенный" (dilated)?
<details>
<summary>Ответ</summary>
Это означает пропускать некоторые точки данных, чтобы видеть дальше назад, не делая больше работы!
</details>

**Вопрос 3**: Почему WaveNet быстрее старых нейросетей?
<details>
<summary>Ответ</summary>
Потому что он смотрит на все данные сразу (параллельно), а не по одному шагу за раз!
</details>

---

## Аналогии из жизни

### WaveNet как умный дневник

Представь, что ведёшь дневник своих оценок:

| Обычный способ | Способ WaveNet |
|----------------|----------------|
| "Какую оценку я получил вчера?" | "Какие оценки я получал все последние месяцы?" |
| Видишь: "4" | Видишь: "4, 5, 4, 3, 5, 5, 4, 4, 5..." |
| Прогноз: "Может, опять 4?" | Прогноз: "У меня обычно 5 после контрольной, а завтра контрольная!" |

### WaveNet как прогноз погоды

Метеорологи не смотрят только на сегодняшнюю погоду. Они смотрят на:
- Погоду за последние дни
- Погоду в это время года за прошлые годы
- Глобальные погодные паттерны

WaveNet делает то же самое с ценами!

### WaveNet как тренер футбольной команды

Хороший тренер изучает:
- Последние игры соперника
- Игры за весь сезон
- Игры за прошлые годы
- Как соперник играет против похожих команд

WaveNet - как такой тренер, но для прогнозирования цен!

---

## Почему это называется "WaveNet"?

**Wave** (волна) - потому что изначально работал с звуковыми волнами (речью и музыкой).

**Net** (сеть) - потому что это нейронная сеть (как мозг из искусственных нейронов).

Вместе: **Волновая сеть** - сеть, которая понимает волнообразные паттерны в данных!

---

*Помни: Даже самый умный компьютер не может идеально предсказать будущее. WaveNet - это инструмент, а не хрустальный шар!*
