# Нейронные сети с передачей сообщений: Простое руководство

## Что такое нейронная сеть с передачей сообщений?

Представь класс, где ученики пытаются решить сложную задачу по математике. Вместо того чтобы работать поодиночке, каждый ученик может шептать подсказки своим соседям. После нескольких раундов шепота каждый ученик знает больше, чем в начале, потому что он объединил свои знания с тем, что узнал от друзей.

**Именно так работают нейронные сети с передачей сообщений (MPNN)!**

## Аналогия с игрой "Испорченный телефон"

Помнишь игру "Испорченный телефон"? Ты шепчешь сообщение другу, он шепчет следующему человеку, и так далее. В конце сообщение проходит через всех.

MPNN похожи, но умнее:
- Каждый человек (узел) начинает с какой-то информацией
- Они "передают сообщения" своим связанным друзьям
- Каждый объединяет то, что слышит, с тем, что знает
- После нескольких раундов каждый учится у всей группы

## Пример из жизни: Школьная сеть сплетен

Допустим, появилась новость о неожиданной контрольной на следующей неделе. Вот как она распространяется:

```
       [Алиса] -------- [Борис]
          |                |
          |                |
       [Катя] --------- [Денис] -------- [Лена]
```

1. **Раунд 1**: Алиса рассказывает Борису и Кате
2. **Раунд 2**: Борис рассказывает Денису, Катя рассказывает Денису (Денис услышал дважды!)
3. **Раунд 3**: Денис рассказывает Лене

Обрати внимание:
- Денис более "связан" - он слышит от нескольких источников
- У Лены только одна связь - она может пропустить новости
- Структура дружбы важна!

## Зачем использовать это для трейдинга?

### Рынок как социальная сеть

На криптовалютных рынках:
- **Bitcoin (BTC)** - это как популярный ребёнок - когда с ним что-то происходит, все замечают
- **Ethereum (ETH)** - лучший друг Bitcoin - они часто двигаются вместе
- **Альткоины** - это как последователи - они реагируют на то, что делают большие монеты

```
         [BTC] ============ [ETH]
          /|\                /|\
         / | \              / | \
        /  |  \            /  |  \
    [SOL] [ADA] [DOT]  [UNI] [AAVE] [LINK]
```

Когда BTC растёт:
1. ETH обычно следует быстро (сильная связь)
2. Другие монеты реагируют позже (слабые связи)
3. Некоторые монеты могут вообще не реагировать (нет связи)

### "Шёпот" в трейдинге

В MPNN для трейдинга "сообщения", которые передаются - это:
- Изменения цены
- Всплески объёма
- Сигналы импульса
- Предупреждения о рисках

## Как это работает? Пошагово

### Шаг 1: Построить сеть

Сначала нужно выяснить, кто с кем "дружит". Для крипты:

```
Сила связи = Насколько эти монеты движутся вместе?

BTC <---> ETH:  Очень сильная (0.9)
BTC <---> DOGE: Средняя (0.5)
ETH <---> UNI:  Сильная (0.7)  # UNI работает на Ethereum
SOL <---> DOGE: Слабая (0.2)
```

### Шаг 2: Собрать информацию

Каждая монета начинает со своими данными:
- Изменение цены сегодня: +5%
- Объём: Высокий
- Импульс: Бычий
- Волатильность: Средняя

### Шаг 3: Передать сообщения

**Раунд 1:**
- BTC говорит ETH: "Я расту на 5%!"
- ETH говорит BTC: "Я тоже, на 3%!"
- Оба обновляют своё понимание

**Раунд 2:**
- BTC теперь знает: "Я расту, ETH растёт... это может быть настоящий тренд"
- ETH теперь знает: "BTC лидирует, надо следить"

**Раунд 3:**
- Сигнал распространяется к альткоинам
- Монеты обновляют свои прогнозы на основе всей сети

### Шаг 4: Принять решения

После всей передачи сообщений каждая монета имеет "счёт":
- Высокий счёт = Сильный сигнал на покупку
- Низкий счёт = Сильный сигнал на продажу
- Средний счёт = Нет чёткого сигнала

## День из жизни MPNN-трейдера

### Утро: Появляются новости

Срочная новость: "Крупная компания объявляет об инвестициях в Bitcoin"

### Сеть реагирует

```
9:00 - BTC взлетает на 5%
  |
  v
9:01 - MPNN обнаруживает: "Сигнал BTC распространяется к ETH"
  |
  v
9:02 - MPNN предсказывает: "Ралли альткоинов вероятно через 5-10 минут"
  |
  v
9:03 - Сигналы на покупку генерируются для выбранных альткоинов
  |
  v
9:10 - Альткоины начинают расти (как предсказывалось!)
  |
  v
9:15 - MPNN обнаруживает ослабление сигналов, готовится к выходу
```

## Три ключевых части

### 1. Функция сообщения (Шёпот)

Какой информацией мы делимся?

Как выбор того, что сказать другу:
- "Контрольная в понедельник" (конкретная информация)
- "Я волнуюсь из-за контрольной" (настроение)
- "Я буду учиться всё выходные" (действие)

В трейдинге:
- "BTC вырос на 5%" (информация о цене)
- "Объём в 3 раза выше нормы" (рыночная активность)
- "RSI в зоне перекупленности" (технический сигнал)

### 2. Функция агрегации (Слушание)

Как мы объединяем сообщения от нескольких друзей?

Варианты:
- **Сумма**: Сложить всё, что слышишь (общее влияние)
- **Среднее**: Взять среднее (сбалансированный взгляд)
- **Максимум**: Запомнить только самое важное (фокус на экстремумах)

Пример:
```
Ты слышишь от 3 друзей:
- "BTC вырос на 5%"
- "BTC вырос на 4%"
- "BTC вырос на 6%"

Сумма: Общее бычье давление = 15%
Среднее: Средний сигнал = 5%
Максимум: Сильнейший сигнал = 6%
```

### 3. Функция обновления (Обучение)

Как мы обновляем собственное мнение?

Как обновление плана учёбы после разговора с друзьями:
- Старый план: Учиться 2 часа
- Совет друга: "Контрольная очень сложная!"
- Новый план: Учиться 4 часа

В трейдинге:
- Старый прогноз: Слегка бычий
- Сообщения сети: Сильный бычий от соседей
- Новый прогноз: Очень бычий

## Почему графы лучше простых методов

### Традиционный подход: Каждый сам за себя

```
BTC: "Я расту, значит я бычий на себя"
ETH: "Я расту, значит я бычий на себя"
SOL: "Я падаю, значит я медвежий на себя"
```

Проблема: Упускает, что рост BTC и ETH может помочь SOL!

### Подход MPNN: Сетевой интеллект

```
BTC: "Я расту + ETH растёт + весь рынок чувствует бычий настрой"
ETH: "Я расту + BTC лидирует + сектор DeFi силён"
SOL: "Я падаю, НО BTC/ETH растут = возможность!"
```

MPNN ловит, что SOL может быть возможностью для покупки!

## Реальный торговый пример

### Сценарий: Восстановление после обвала

День 1: Рынок падает на -20%
```
Все узлы: [СТРАХ СТРАХ СТРАХ]
```

День 3: BTC показывает первую зелёную свечу
```
BTC: "Я восстанавливаюсь"
     |
     v
MPNN: "Сигнал отправлен к ETH"
     |
     v
ETH: "BTC восстанавливается + я стабилизируюсь = хороший знак"
     |
     v
MPNN: "Позитивные сигналы распространяются по сети"
     |
     v
Альткоины: "Лидеры восстанавливаются + страх уменьшается = сигналы ПОКУПКА"
```

MPNN обнаруживает восстановление, распространяющееся по сети, ДО того как каждый отдельный актив чётко это покажет!

## Ключевые выводы

1. **Рынки - это сети** - Криптоактивы связаны, не независимы
2. **Информация распространяется** - То, что происходит с BTC, влияет на всё
3. **Структура важна** - Некоторые монеты более связаны, чем другие
4. **Тайминг важен** - MPNN могут обнаруживать сигналы до их полного распространения
5. **Больше, чем корреляция** - MPNN учатся сложным, многошаговым отношениям

## Резюме: Рецепт MPNN

1. **Ингредиенты**:
   - Криптоактивы (узлы)
   - Связи (рёбра)
   - Рыночные данные (признаки)

2. **Процесс**:
   - Построить сеть отношений
   - Позволить каждому активу делиться информацией
   - Объединить сообщения от соседей
   - Обновить прогнозы
   - Повторить несколько раз

3. **Результат**:
   - Каждый актив получает сигнал, информированный всей сетью
   - Сигналы естественно распространяются через связи
   - Раннее обнаружение рыночных движений

## Следующие шаги

Готов увидеть это в действии? Посмотри примеры на Rust в папке `rust/`:
- `basic_mpnn.rs` - Простой пример с тестовыми данными
- `bybit_signals.rs` - Реальные крипто-данные с Bybit
- `backtest.rs` - Тестирование стратегии на исторических данных

Помни: Сеть умнее любого отдельного узла!
