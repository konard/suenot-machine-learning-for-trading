# Crypto RNN - –†–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã–µ –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏ –¥–ª—è –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç ü¶Ä

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –Ω–∞ Rust –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è —Ü–µ–Ω –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º LSTM –∏ GRU, —Å –¥–∞–Ω–Ω—ã–º–∏ –±–∏—Ä–∂–∏ Bybit.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üìä **–ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö**: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å API Bybit (—Å–ø–æ—Ç–æ–≤—ã–π —Ä—ã–Ω–æ–∫)
- üß† **–ú–æ–¥–µ–ª–∏**: LSTM –∏ GRU —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –º–Ω–æ–≥–æ—Å–ª–æ–π–Ω—ã—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä
- ‚öôÔ∏è **–ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞**: –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è, —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π, —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã
- üìà **–ú–µ—Ç—Ä–∏–∫–∏**: MSE, RMSE, MAE, R¬≤, Sharpe Ratio, Maximum Drawdown
- üíæ **–°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è**: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ/–∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–µ–π –∏ –¥–∞–Ω–Ω—ã—Ö

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
cd 19_recurrent_neural_nets/rust
cargo build --release
```

### –ü—Ä–∏–º–µ—Ä—ã

#### 1. –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

```bash
# –°–∫–∞—á–∞—Ç—å 1000 —á–∞—Å–æ–≤—ã—Ö —Å–≤–µ—á–µ–π BTC
cargo run --example fetch_data

# –° –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏: —Å–∏–º–≤–æ–ª, –∏–Ω—Ç–µ—Ä–≤–∞–ª, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
cargo run --example fetch_data ETHUSDT 4h 500
```

#### 2. –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

```bash
# –û–±—É—á–∏—Ç—å LSTM –º–æ–¥–µ–ª—å
cargo run --example train_lstm --release

# –° –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
SYMBOL=ETHUSDT EPOCHS=100 HIDDEN=128 cargo run --example train_lstm --release
```

#### 3. –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –°–¥–µ–ª–∞—Ç—å –ø—Ä–æ–≥–Ω–æ–∑ —Å –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª—å—é
cargo run --example predict

# –î–ª—è –¥—Ä—É–≥–æ–≥–æ —Å–∏–º–≤–æ–ª–∞
SYMBOL=ETHUSDT cargo run --example predict
```

#### 4. –ü–æ–ª–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª: –¥–∞–Ω–Ω—ã–µ ‚Üí –æ–±—É—á–µ–Ω–∏–µ ‚Üí –æ—Ü–µ–Ω–∫–∞ ‚Üí –ø—Ä–æ–≥–Ω–æ–∑
cargo run --example full_pipeline --release
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
rust/
‚îú‚îÄ‚îÄ Cargo.toml              # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ lib.rs              # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ data/               # –ú–æ–¥—É–ª—å —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ mod.rs
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ bybit.rs        # –ö–ª–∏–µ–Ω—Ç Bybit API
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ types.rs        # –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö (Candle, Interval)
‚îÇ   ‚îú‚îÄ‚îÄ preprocessing/      # –ú–æ–¥—É–ª—å –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ mod.rs
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ processor.rs    # –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ normalizer.rs   # Min-Max –∏ Z-score –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ features.rs     # –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ model/              # –ú–æ–¥—É–ª—å –º–æ–¥–µ–ª–µ–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ mod.rs
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config.rs       # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ layers.rs       # Dense, Activation, Dropout
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ lstm.rs         # LSTM —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ gru.rs          # GRU —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ utils/              # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
‚îÇ       ‚îú‚îÄ‚îÄ mod.rs
‚îÇ       ‚îú‚îÄ‚îÄ metrics.rs      # –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞
‚îÇ       ‚îî‚îÄ‚îÄ io.rs           # –†–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–∞–º–∏
‚îî‚îÄ‚îÄ examples/               # –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
    ‚îú‚îÄ‚îÄ fetch_data.rs       # –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
    ‚îú‚îÄ‚îÄ train_lstm.rs       # –û–±—É—á–µ–Ω–∏–µ LSTM
    ‚îú‚îÄ‚îÄ predict.rs          # –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ
    ‚îî‚îÄ‚îÄ full_pipeline.rs    # –ü–æ–ª–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–∞–∫ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

```rust
use crypto_rnn::data::BybitClient;
use crypto_rnn::preprocessing::DataProcessor;
use crypto_rnn::model::{LSTM, LSTMConfig};

#[tokio::main]
async fn main() -> anyhow::Result<()> {
    // 1. –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ
    let client = BybitClient::new();
    let candles = client.get_klines("BTCUSDT", "1h", 1000).await?;

    // 2. –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ
    let mut processor = DataProcessor::new(60, 1);
    let (x, y) = processor.prepare_sequences(&candles)?;
    let (x_train, x_test, y_train, y_test) = processor.train_test_split(&x, &y, 0.8);

    // 3. –°–æ–∑–¥–∞—ë–º –∏ –æ–±—É—á–∞–µ–º –º–æ–¥–µ–ª—å
    let config = LSTMConfig::new(x.shape()[2], 64, 1)
        .with_learning_rate(0.001)
        .with_batch_size(32);

    let mut lstm = LSTM::from_config(config);
    lstm.train(&x_train, &y_train, 50, 0.001)?;

    // 4. –û—Ü–µ–Ω–∏–≤–∞–µ–º
    let test_loss = lstm.evaluate(&x_test, &y_test);
    println!("Test Loss: {:.6}", test_loss);

    // 5. –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º
    let prediction = lstm.predict(&x_test);
    println!("Predictions: {:?}", prediction);

    Ok(())
}
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π

```rust
use crypto_rnn::model::LSTMConfig;

// –ü—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
let small = LSTMConfig::small(5, 1);    // 32 hidden units
let medium = LSTMConfig::medium(5, 1);  // 64 hidden, 2 layers
let large = LSTMConfig::large(5, 1);    // 128 hidden, 3 layers, dropout

// –ö–∞—Å—Ç–æ–º–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
let config = LSTMConfig::new(5, 64, 1)
    .with_learning_rate(0.001)
    .with_dropout(0.2)
    .with_layers(2)
    .with_batch_size(32)
    .with_gradient_clip(1.0);
```

## –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã

| –ö–æ–¥ | –ò–Ω—Ç–µ—Ä–≤–∞–ª |
|-----|----------|
| `1` –∏–ª–∏ `1m` | 1 –º–∏–Ω—É—Ç–∞ |
| `5` –∏–ª–∏ `5m` | 5 –º–∏–Ω—É—Ç |
| `15` –∏–ª–∏ `15m` | 15 –º–∏–Ω—É—Ç |
| `60` –∏–ª–∏ `1h` | 1 —á–∞—Å |
| `240` –∏–ª–∏ `4h` | 4 —á–∞—Å–∞ |
| `D` –∏–ª–∏ `1d` | 1 –¥–µ–Ω—å |
| `W` –∏–ª–∏ `1w` | 1 –Ω–µ–¥–µ–ª—è |

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã

–ú–æ–¥—É–ª—å `preprocessing::features` –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç:

- **OHLCV**: Open, High, Low, Close, Volume
- **Returns**: –ü—Ä–æ—Ü–µ–Ω—Ç–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–Ω—ã
- **Range**: High - Low
- **SMA**: Simple Moving Average
- **EMA**: Exponential Moving Average
- **RSI**: Relative Strength Index
- **MACD**: Moving Average Convergence Divergence
- **Bollinger Bands**: –í–µ—Ä—Ö–Ω—è—è, —Å—Ä–µ–¥–Ω—è—è, –Ω–∏–∂–Ω—è—è –ø–æ–ª–æ—Å—ã

## –ú–µ—Ç—Ä–∏–∫–∏

```rust
use crypto_rnn::utils::{mse, rmse, mae, mape, r2_score, accuracy};

let mse_val = mse(&y_true, &y_pred);           // Mean Squared Error
let rmse_val = rmse(&y_true, &y_pred);         // Root MSE
let mae_val = mae(&y_true, &y_pred);           // Mean Absolute Error
let mape_val = mape(&y_true, &y_pred);         // Mean Absolute % Error
let r2 = r2_score(&y_true, &y_pred);           // R¬≤ Score
let acc = accuracy(&y_true, &y_pred, 0.5);     // Classification Accuracy
```

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- `reqwest` - HTTP –∫–ª–∏–µ–Ω—Ç –¥–ª—è API
- `ndarray` - –ú–Ω–æ–≥–æ–º–µ—Ä–Ω—ã–µ –º–∞—Å—Å–∏–≤—ã
- `tokio` - –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —Ä–∞–Ω—Ç–∞–π–º
- `serde` - –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è
- `indicatif` - –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä—ã

## –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

- –û–±—É—á–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —É–ø—Ä–æ—â—ë–Ω–Ω—ã–π —á–∏—Å–ª–µ–Ω–Ω—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç (–º–µ–¥–ª–µ–Ω–Ω–µ–µ, —á–µ–º –∞–≤—Ç–æ–¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏—Ä–æ–≤–∞–Ω–∏–µ)
- –ù–µ—Ç GPU —É—Å–∫–æ—Ä–µ–Ω–∏—è
- –≠—Ç–æ —É—á–µ–±–Ω—ã–π –ø—Ä–∏–º–µ—Ä, –Ω–µ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

## –û—Ç–∫–∞–∑ –æ—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏

‚ö†Ô∏è **–í–ù–ò–ú–ê–ù–ò–ï**: –≠—Ç–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ —Å–æ–∑–¥–∞–Ω–∞ –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –≤ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª—è—Ö.

- –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏
- –ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω—ã–π —Ä—ã–Ω–æ–∫ –≤—ã—Å–æ–∫–æ –≤–æ–ª–∞—Ç–∏–ª–µ–Ω
- –ü—Ä–æ—à–ª—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É—é—Ç –±—É–¥—É—â–∏—Ö
- –ú–æ–¥–µ–ª–∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –º–æ–≥—É—Ç –æ—à–∏–±–∞—Ç—å—Å—è

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT
