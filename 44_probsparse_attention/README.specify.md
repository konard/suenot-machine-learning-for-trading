# Chapter 44: ProbSparse Attention для Trading

## Описание

ProbSparse attention снижает вычислительную сложность O(n²) до O(n log n), выбирая только наиболее значимые query-key пары.

## Техническое задание

### Цели
1. Изучить теоретические основы метода
2. Реализовать базовую версию на Python
3. Создать оптимизированную версию на Rust
4. Протестировать на финансовых данных
5. Провести бэктестинг торговой стратегии

### Ключевые компоненты
- Теоретическое описание метода
- Python реализация с PyTorch
- Rust реализация для production
- Jupyter notebooks с примерами
- Бэктестинг framework

### Метрики
- Accuracy / F1-score для классификации
- MSE / MAE для регрессии
- Sharpe Ratio / Sortino Ratio для стратегий
- Maximum Drawdown
- Сравнение с baseline моделями

## Научные работы

1. **Informer: Beyond Efficient Transformer for Long Sequence Time-Series Forecasting**
   - URL: https://arxiv.org/abs/2012.07436
   - Год: 2021

2. **Comparing Different Transformer Model Structures for Stock Prediction**
   - URL: https://arxiv.org/abs/2504.16361
   - Год: 2025

## Данные
- Yahoo Finance / yfinance
- Binance API для криптовалют
- LOBSTER для order book data
- Kaggle финансовые датасеты

## Реализация

### Python
- PyTorch / TensorFlow
- NumPy, Pandas
- scikit-learn
- Backtrader / Zipline

### Rust
- ndarray
- polars
- burn / candle

## Структура
```
44_probsparse_attention/
├── README.specify.md
├── README.md
├── docs/
│   └── ru/
│       └── theory.md
├── python/
│   ├── model.py
│   ├── train.py
│   ├── backtest.py
│   └── notebooks/
│       └── example.ipynb
└── rust/
    └── src/
        └── lib.rs
```
