# Байесовское машинное обучение — объяснение простыми словами

Представь, что ты детектив, который расследует загадку. У тебя есть догадки, а потом ты находишь улики и меняешь своё мнение. Именно так работает байесовский подход!

## Что такое байесовская статистика?

### Пример из жизни: Угадай, что в коробке!

Представь, что друг спрятал что-то в коробке. Ты думаешь:
- «Скорее всего это игрушка» (твоё начальное предположение — **априорная вероятность**)

Потом ты трясёшь коробку и слышишь шуршание:
- «Хм, это звучит как бумага...» (новая информация — **данные**)

Теперь ты обновляешь своё мнение:
- «Наверное, это книга или открытка!» (обновлённое мнение — **апостериорная вероятность**)

**Это и есть суть байесовского подхода**: начинаем с предположения, получаем новую информацию, обновляем предположение.

## Два разных взгляда на вероятность

### Частотный подход (классический)

Представь, что ты бросаешь монетку 1000 раз и считаешь, сколько раз выпал орёл. Если орёл выпал 500 раз, ты говоришь: «Вероятность орла = 50%».

**Проблема**: А что если событие случается редко? Например, как часто падают метеориты на твой дом? Ты не можешь подождать 1000 лет, чтобы посчитать!

### Байесовский подход

Ты говоришь: «Я думаю, что вероятность примерно такая, но я не уверен на 100%». Когда появляется новая информация, ты обновляешь свою оценку.

**Пример**: Ты думаешь, что завтра будет солнечно (80% уверенности). Вечером смотришь прогноз погоды — обещают тучи. Теперь твоя уверенность в солнце падает до 30%.

## Теорема Байеса — волшебная формула обновления

### История про врача и болезнь

Представь такую ситуацию:
- Редкая болезнь встречается у 1 из 1000 человек
- Тест на эту болезнь правильно определяет больных в 99% случаев
- Но тест также ошибочно показывает «больной» у 5% здоровых людей

**Вопрос**: Если тест показал «положительно», какова вероятность, что ты действительно болен?

Многие думают: «99%!» Но это неправильно!

**Правильный ответ** (по теореме Байеса): около 2%!

Почему? Потому что болезнь очень редкая! Из 1000 человек:
- 1 человек болен, и тест почти наверняка покажет «+» (это правда)
- 999 здоровы, но примерно 50 из них получат ложный «+»

Итого: 51 положительный результат, но только 1 действительно болен. 1/51 ≈ 2%!

**Мораль**: Начальное предположение (болезнь редкая) очень важно!

## Как это помогает в торговле?

### Пример: Угадываем направление цены

Представь, что ты пытаешься понять: цена акции завтра вырастет или упадёт?

**Обычный способ**: Посмотреть на 1000 прошлых дней и посчитать, сколько раз цена росла.

**Байесовский способ**:
1. Начать с предположения: «Я думаю, шансы роста примерно 50/50»
2. Смотреть на каждый новый день
3. Обновлять мнение: «О, сегодня выросло, значит мои шансы чуть сдвигаются в сторону роста»
4. С каждым днём картина становится всё яснее

**Преимущество**: Ты не ждёшь 1000 дней — ты учишься постепенно!

### Пример: Сравниваем две стратегии

Представь, что у тебя два способа выбирать акции:
- Стратегия А: смотреть на новости
- Стратегия Б: смотреть на графики

Какая лучше?

**Обычный способ** говорит: «Стратегия А дала 10% прибыли, стратегия Б — 8%. Значит А лучше!»

**Байесовский способ** говорит: «Погоди! Может, стратегии А просто повезло? Давай посмотрим на полную картину неопределённости».

И он показывает не одно число, а целый диапазон: «Стратегия А даёт от 5% до 15% с разной вероятностью». Это как сказать не «ты получишь ровно 100 рублей», а «ты получишь от 50 до 150 рублей, скорее всего около 100».

## Что такое коэффициент Шарпа?

### Простое объяснение

Представь две игры:
- **Игра 1**: Ты можешь выиграть 10 рублей, но иногда теряешь 5
- **Игра 2**: Ты можешь выиграть 20 рублей, но иногда теряешь 15

Какая игра лучше? Нужно учитывать и выигрыш, и риск!

**Коэффициент Шарпа** — это как оценка «выигрыш на единицу риска». Чем выше число, тем лучше: больше награды за меньший риск.

Байесовский подход говорит: «Я не просто скажу тебе одно число. Я покажу, насколько я в нём уверен!»

## Парная торговля — торговля «друзьями»

### Пример из жизни: Два друга

Представь двух друзей, Петю и Васю, которые всегда ходят вместе. Если Петя убежал вперёд, то скорее всего Вася скоро его догонит. Если Петя отстал — скорее всего он ускорится.

В мире акций есть такие «пары друзей» — акции, которые обычно двигаются вместе. Например:
- Coca-Cola и Pepsi (обе делают газировку)
- Visa и Mastercard (обе — платёжные системы)

**Стратегия**:
1. Если одна акция «убежала вперёд» (подорожала слишком сильно) — продаём её
2. Если другая «отстала» (подешевела слишком сильно) — покупаем её
3. Ждём, пока они «встретятся» снова
4. Получаем прибыль!

**Байесовский подход** помогает понять: «Насколько сильно связаны эти акции?» и обновлять это понимание с каждым днём.

## Волатильность — настроение рынка

### Пример: Качели на детской площадке

Представь качели:
- **Спокойный день**: качели качаются чуть-чуть, медленно
- **Ветреный день**: качели летают туда-сюда очень сильно

Рынок тоже бывает «спокойный» и «ветреный»:
- **Низкая волатильность**: цены меняются понемногу
- **Высокая волатильность**: цены прыгают вверх-вниз как сумасшедшие

**Стохастическая волатильность** — это понимание того, что «ветреность» рынка сама по себе меняется и непредсказуема.

Байесовский подход помогает оценить: «Какая сейчас волатильность? И насколько я в этом уверен?»

## PyMC3 — компьютерный помощник для байесовских расчётов

### Зачем нужен PyMC3?

Представь, что тебе нужно решить очень сложную математическую задачу. Ты можешь:
1. Решать её вручную (долго и сложно)
2. Попросить компьютер (быстро и легко)

**PyMC3** — это программа для компьютера, которая делает всю сложную байесовскую математику за тебя. Ты просто говоришь:
- «Вот мои начальные предположения»
- «Вот мои данные»

А компьютер отвечает:
- «Вот что я думаю, учитывая всё это!»

## Метод Монте-Карло — игра в случайности

### Пример: Как измерить площадь озера?

Представь озеро неправильной формы. Как узнать его площадь?

**Метод Монте-Карло**:
1. Возьми квадратную карту, на которой нарисовано озеро
2. Закрой глаза и тыкай пальцем в случайные места (1000 раз)
3. Посчитай, сколько раз попал в озеро
4. Если попал 300 раз из 1000, значит озеро занимает примерно 30% карты!

Так же работают **MCMC** (Марковские цепи Монте-Карло) в байесовской статистике — они «тыкают» в разные варианты параметров и смотрят, какие из них лучше объясняют данные.

## Главные идеи главы

1. **Байесовский подход** = начни с догадки, обновляй её по мере получения информации

2. **Это как детектив**: сначала подозреваешь всех, потом находишь улики и меняешь мнение

3. **Преимущество для финансов**: можно работать с редкими событиями и маленьким количеством данных

4. **Честность про неопределённость**: вместо «цена вырастет на 10%» говорим «цена, скорее всего, вырастет на 5-15%»

5. **PyMC3** — компьютерная программа, которая делает всю сложную математику за нас

## Практические примеры в этой главе

| Ноутбук | Что он делает | Простое объяснение |
|---------|---------------|-------------------|
| [01_updating_conjugate_priors](01_updating_conjugate_priors.ipynb) | Обновление оценок движения цен | Как угадывать, куда пойдёт цена, и учиться на ошибках |
| [02_pymc3_workflow](02_pymc3_workflow.ipynb) | Предсказание рецессии | Как понять, будет ли экономике плохо |
| [03_bayesian_sharpe_ratio](03_bayesian_sharpe_ratio.ipynb) | Сравнение стратегий | Какая стратегия лучше с учётом неопределённости |
| [04_rolling_regression](04_rolling_regression.ipynb) | Парная торговля | Как найти «друзей» среди акций |
| [05_stochastic_volatility](05_stochastic_volatility.ipynb) | Модели волатильности | Как понять «настроение» рынка |

## Итог: Почему байесовский подход крутой?

Представь двух людей:
- **Упрямый**: «Я думаю, что цена вырастет, и точка!»
- **Мудрый**: «Я думаю, что цена, скорее всего, вырастет, но я готов изменить мнение, если увижу новые данные»

Байесовский подход — это способ быть **мудрым**:
- Признавать, что ты не знаешь всего на 100%
- Учиться на новой информации
- Честно говорить о своей неуверенности

И в мире денег это очень важно, потому что **честность про риски** помогает не потерять всё!
